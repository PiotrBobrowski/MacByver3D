3D versions of the algorithms
